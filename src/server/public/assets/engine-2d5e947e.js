import{d as x,_,o as r,c,F as y,m as k,n as b,a as s,t as h,p as N,b as S,r as w,e as f,q as I,x as u,g as E,l as v,s as C,y as P}from"./index-c60d195c.js";async function z(t){let o={url:"https://api.open-meteo.com/v1/forecast?",params:{latitude:t.lat,longitude:t.lon,hourly:"temperature_2m,relativehumidity_2m,apparent_temperature,precipitation_probability,precipitation,rain,showers,snowfall,snow_depth,cloudcover,cloudcover_low,cloudcover_mid,cloudcover_high,visibility,uv_index,windspeed_10m,windspeed_80m",daily:"weathercode,temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,sunrise,sunset,uv_index_max,precipitation_sum,precipitation_hours,precipitation_probability_max,windspeed_10m_max",forecast_days:1,timezone:"America/Sao_Paulo"}},e=x(o);if(e)return e;throw new error("error")}async function V(t){var o={method:"get",url:`https://api.geoapify.com/v1/geocode/reverse?lat=${t.lat}&lon=${t.lon}&apiKey=0ae00d59fad04fca9ec58035b84f7e82`};let e=x(o);if(e)return e;throw new error("error")}const B="/notification.svg";const W={props:["notification"],data(){return{messages:[]}},mounted(){this.notification&&this.showNotification(this.notification.message)},methods:{deleteNotification(t){this.messages.indexOf(t.target.innerText)},showNotification(t){let o={},e=Math.floor(Math.random()*1e3);o.id=e,o.message=t,o.show=!0,this.messages.push(o),setTimeout(()=>{for(let d=0;d<this.messages.length;d++)if(this.messages[d].id===e){this.messages[d].show=!1,setTimeout(()=>{this.messages.splice(d,1)},1e3);break}},5e3)}},watch:{notification:function(){this.showNotification(this.notification.message)}}},j=t=>(N("data-v-1d3326b1"),t=t(),S(),t),M={class:"absolute right-6 top-4 gap-4 flex flex-col items-end"},F=j(()=>s("div",null,[s("img",{src:B,alt:"Notificação",class:"h-6 invert"})],-1));function H(t,o,e,d,n,i){return r(),c("div",M,[(r(!0),c(y,null,k(n.messages,a=>(r(),c("div",{class:b([a.show?"notification":"out","min-w-0 py-3 bg-gray-700 text-white rounded flex items-center p-4"]),style:{transition:"all 0.3s ease-in-out",width:"fit-content"},onClick:o[0]||(o[0]=(...l)=>i.deleteNotification&&i.deleteNotification(...l))},[F,s("div",null,h(a.message),1)],2))),256))])}const L=_(W,[["render",H],["__scopeId","data-v-1d3326b1"]]),R={props:["icon","value","name"],data(){return{}}},K={class:"text-[#FCE142] grid grid-rows-2 text-center items-center gap-2 h-full"},U={class:"flex justify-center"},q=["src"],A={class:"flex flex-col gap-1"},G={class:"text-center font-bold text-sm sm:text-xl"},O={class:"text-center text-[12px] sm:text-lg"};function J(t,o,e,d,n,i){return r(),c("div",K,[s("span",U,[s("img",{src:e.icon||"/realfeet.svg",alt:""},null,8,q)]),s("div",A,[s("span",G,h(this.value),1),s("span",O,h(this.name),1)])])}const Q=_(R,[["render",J]]);const X={props:["previsaoDoTempo","countdown","id"],data(){return{progress:0,time:this.countdown,intervalId:this.id||null}},components:{weatherBanners:Q},methods:{startTimer(){this.intervalId&&clearInterval(this.intervalId),this.progress=0;const t=100/this.time;this.intervalId=setInterval(()=>{this.progress+=t,this.progress>=100+this.time/10&&(clearInterval(this.intervalId),this.$emit("countdown"))},1e3)},resetProgress(){this.progress=0},handleConcluded(){console.log("Tempo concluído!")}},watch:{news(t){this.resetProgress(),this.startTimer()},time(t){this.resetProgress()}},mounted(){this.time>0&&this.startTimer()}},Y={class:"fade-enter-active bg-[black] relative rounded-xl py-4 px-10 hidden sm:flex flex-col overflow-hidden h-[11em] gap-10"},Z={class:"flex w-full justify-between items-center"},ee={key:0,class:"w-full h-4 bg-black absolute bottom-0 left-0"};function te(t,o,e,d,n,i){var l,m,p,g,T,D,$;const a=w("weatherBanners");return r(),c("div",Y,[s("div",Z,[f(a,{name:"Vento",value:((l=e.previsaoDoTempo.hourly)==null?void 0:l.windspeed_10m[new Date().getHours()])+"km/h",icon:"/wind.svg"},null,8,["value"]),f(a,{name:"Humidade",value:((p=(m=e.previsaoDoTempo)==null?void 0:m.hourly)==null?void 0:p.relativehumidity_2m[new Date().getHours()])+"%",icon:"/humidity.svg"},null,8,["value"]),f(a,{name:"Visibilidade",value:((T=(g=e.previsaoDoTempo)==null?void 0:g.hourly)==null?void 0:T.visibility[new Date().getHours()])/1e3+"KM",icon:"/visibility.svg"},null,8,["value"]),f(a,{name:"Sensação Termica",value:(($=(D=e.previsaoDoTempo)==null?void 0:D.hourly)==null?void 0:$.apparent_temperature[new Date().getHours()])+"ºC",icon:"/realfeet.svg"},null,8,["value"])]),e.countdown>0?(r(),c("div",ee,[s("div",{style:I(`width: ${n.progress}%`),class:b("progress-bar h-full bg-[gray] rounded-r-full")},null,4)])):u("",!0)])}const se=_(X,[["render",te]]),oe={props:["news","countdown","id"],data(){return{progress:0,time:this.countdown||10,intervalId:this.id||null}},methods:{startTimer(){this.intervalId&&clearInterval(this.intervalId),this.progress=0;const t=100/this.time;this.intervalId=setInterval(()=>{this.progress+=t,this.progress>=110&&(clearInterval(this.intervalId),this.$emit("countdown"))},1e3)},resetProgress(){this.progress=0},handleConcluded(){console.log("Tempo concluído!")}},watch:{news(t){this.resetProgress(),this.startTimer()},time(t){this.countdown=t,this.resetProgress()}},mounted(){this.startTimer()}},ne={class:"bg-[black] relative text-white rounded-xl py-6 px-10 hidden sm:flex flex-col gap-y-6"},ie={class:"flex items-center gap-x-2"},ae=["src"],re={class:"flex flex-col",style:{"padding-bottom":"1em"}},le={class:"font-bold text-xl pb-2"},ce={class:"text-sm"},de={class:"w-full h-4 bg-black absolute bottom-0 left-0 rounded"};function he(t,o,e,d,n,i){var a,l;return r(),c("div",ne,[s("header",ie,[(a=e.news)!=null&&a.icon?(r(),c("img",{key:0,src:(l=e.news)==null?void 0:l.icon,alt:"",class:"w-8 h-8 contain"},null,8,ae)):u("",!0),s("span",null,h(e.news.source),1)]),s("section",re,[s("span",le,h(e.news.title),1),s("span",ce,h(new Date(e.news.isoDate).toLocaleDateString())+" - "+h(new Date(e.news.isoDate).toLocaleTimeString()),1),s("span",null,h(e.news.contentSnippet.split(".")[0]),1)]),s("div",de,[s("div",{style:I(`width: ${n.progress}%; transition: width ${100/n.time} ease;`),class:b("progress-bar h-full bg-[gray] rounded-r-full")},null,4)])])}const ue=_(oe,[["render",he]]),me={props:["localizacao","previsaoDoTempo","news"],data(){return{feed:[],card:"weather",newsIndex:0,weatherCountdown:0}},mounted(){this.news&&this.readRssFeed()},methods:{async readRssFeed(){let t=new RSSParser,o=[],e=0;this.news.forEach(d=>{e=e+1,t.parseURL(d.url,async function(n,i){if(n)throw n;i.items.forEach(a=>{var l;o.push({...a,source:i.title,icon:(l=i.image)!=null&&l.url?i.image.url:"https://www.google.com/s2/favicons?domain="+i.link})}),o.sort((a,l)=>{const m=new Date(a.isoDate);return new Date(l.isoDate)-m}),console.log(o)})}),console.log(o),this.feed=o,e!==0&&(this.weatherCountdown=4)},nextCard(){if(this.card="nothing",this.newsIndex++,this.newsIndex/5%1==0)return this.card="weather";if(!this.NEWS)return this.card="weather";this.newsIndex>=this.feed.length&&(this.card="weather",this.newsIndex=0),this.card="news"}},computed:{NEWS(){return this.feed&&this.feed.length>this.newsIndex?this.feed[this.newsIndex]:null}},components:{weatherCard:se,newsCard:ue}},pe={key:0,class:"flex flex-col items-center gap-12 w-full h-full gap-4 grid grid-cols-12 grid-rows-6"},_e={class:"flex justify-center items-center w-full h-full grid col-start-4 col-end-10 row-start-2 row-span-2"},fe={class:"flex flex-col text-center gap-2 sm:gap-2"},we={class:"font-bold text-xl sm:text-[3em] leading-[100%]"},ge={class:"text-[.7em]"},ve={class:"text-[10em] sm:text-[12em] font-bold rubik text-center",style:{"line-height":"1"}},xe={class:"w-full h-full grid col-start-4 col-end-10 row-start-4 row-span-1"},ye={key:1},be=s("div",{class:"flex flex-col items-center"},[s("div",{class:"flex flex-col text-center"},[s("span",{class:"font-bold text-lg sm:text-[4em]"},"Loading...")])],-1),Te=[be];function De(t,o,e,d,n,i){var m,p;const a=w("weatherCard"),l=w("newsCard");return r(),c(y,null,[e.previsaoDoTempo?(r(),c("div",pe,[s("div",_e,[s("div",fe,[s("span",we,[E(h(e.localizacao.city)+", ",1),s("span",ge,h(e.localizacao.county),1)])]),s("span",ve,h(Math.round((p=(m=e.previsaoDoTempo)==null?void 0:m.hourly)==null?void 0:p.temperature_2m[new Date().getHours()])+"º"),1)]),s("div",xe,[n.card=="weather"?(r(),v(a,{key:0,onCountdown:o[0]||(o[0]=g=>i.nextCard()),countdown:n.weatherCountdown,id:"weather",previsaoDoTempo:e.previsaoDoTempo},null,8,["countdown","previsaoDoTempo"])):u("",!0),i.NEWS&&n.card=="news"?(r(),v(l,{key:1,onCountdown:o[1]||(o[1]=g=>i.nextCard()),countdown:"10",id:i.NEWS.url,news:i.NEWS},null,8,["id","news"])):u("",!0)])])):u("",!0),e.previsaoDoTempo?u("",!0):(r(),c("div",ye,Te))],64)}const $e=_(me,[["render",De]]),Ce="/menu.svg",Ie={data(){return{location:"",address:"",previsaoDoTempo:"",notification:"",component:"um",news:[]}},methods:{async locate(){let t=await z(this.location);this.previsaoDoTempo=t.data,this.address=await V(this.location),this.address=this.address.data.features[0].properties},ShortCounty(){return BrazilShortCounty()},getPainel(){let t={method:"GET",url:"https://192.168.100.29:3000/display/"+this.$route.params.id,headers:{"Content-Type":"application/json"},withCredentials:!0};x(t).then(o=>(this.location=o.data.geo,this.locate(),this.news=o.data.NEWS,!0)).catch(o=>{alert(o)})}},mounted(){this.getPainel(),C.emit("join",this.$route.params.id),C.on("updateWeather",(...t)=>{this.getPainel(),this.notification={id:Math.floor(Math.random()),title:"Weather Updated",message:"The weather has been updated",type:"success"}})},components:{avaliableDisplay:P,modalNotification:L,um:$e}},ke={class:"w-[100vw] sm:h-[100vh] h-[94vh] bg-[#FCE142] flex flex-col items-center p-10"},Ne={class:"w-full h-full flex flex-col"},Se=s("header",null,[s("img",{src:Ce,alt:""})],-1),Ee={key:0,class:"flex flex-col h-full justify-center"},Pe={key:1,class:"flex flex-col h-full justify-center gap-[8em] text-center"},ze=s("span",null,"Necessario permissão de localização",-1),Ve=[ze];function Be(t,o,e,d,n,i){const a=w("modalNotification"),l=w("um");return r(),c(y,null,[f(a,{notification:n.notification},null,8,["notification"]),s("div",ke,[s("div",Ne,[Se,n.location?(r(),c("div",Ee,[n.component=="um"?(r(),v(l,{key:0,class:"h-full",news:n.news,localizacao:n.address,previsaoDoTempo:n.previsaoDoTempo},null,8,["news","localizacao","previsaoDoTempo"])):u("",!0)])):u("",!0),n.location?u("",!0):(r(),c("div",Pe,Ve))])])],64)}const je=_(Ie,[["render",Be]]);export{je as default};
